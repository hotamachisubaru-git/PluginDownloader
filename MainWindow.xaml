<Window x:Class="PluginDownloader.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="PluginDownloader"
        Height="760"
        Width="1280"
        MinHeight="640"
        MinWidth="980">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Padding="12" CornerRadius="8" Background="#F2F6FA" BorderBrush="#D7E0EA" BorderThickness="1">
            <StackPanel>
                <TextBlock FontSize="24" FontWeight="SemiBold" Text="PluginDownloader" />
                <TextBlock Margin="0,6,0,0"
                           TextWrapping="Wrap"
                           Foreground="#374151"
                           Text="Bukkit/Paper系プラグインとPaper本体Jarを解析し、最新バージョンを自動取得します。左ペインに更新対象を追加してから「更新実行」を押してください。" />
            </StackPanel>
        </Border>

        <Grid Grid.Row="1" Margin="0,12,0,12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,0,8,0" VerticalAlignment="Center" Text="保存先フォルダ" />
            <TextBox x:Name="OutputDirectoryTextBox" Grid.Row="0" Grid.Column="1" MinWidth="360" Padding="8,6" />
            <Button x:Name="BrowseOutputFolderButton" Grid.Row="0" Grid.Column="2" Margin="8,0,0,0" Padding="14,6" Content="参照..." Click="BrowseOutputFolderButton_Click" />
            <CheckBox x:Name="PromptEveryRunCheckBox"
                      Grid.Row="0"
                      Grid.Column="3"
                      Margin="16,0,0,0"
                      VerticalAlignment="Center"
                      Content="毎回実行時に保存先を選択" />

            <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Margin="0,10,0,0" Orientation="Horizontal">
                <Button x:Name="AddPluginsButton" Padding="14,7" Content="Jar追加..." Click="AddPluginsButton_Click" />
                <Button x:Name="AddPaperButton" Margin="8,0,0,0" Padding="14,7" Content="Paper本体追加..." Click="AddPaperButton_Click" />
                <Button x:Name="AddFolderButton" Margin="8,0,0,0" Padding="14,7" Content="フォルダ追加..." Click="AddFolderButton_Click" />
                <Button x:Name="RemoveSelectedButton" Margin="8,0,0,0" Padding="14,7" Content="選択削除" Click="RemoveSelectedButton_Click" />
                <Button x:Name="ClearAllButton" Margin="8,0,0,0" Padding="14,7" Content="一覧クリア" Click="ClearAllButton_Click" />
                <Button x:Name="RunUpdateButton" Margin="16,0,0,0" Padding="18,7" FontWeight="SemiBold" Content="更新実行" Click="RunUpdateButton_Click" />
            </StackPanel>
        </Grid>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <GroupBox Grid.Column="0" Header="更新対象（Plugin / Paper）" Margin="0,0,6,0">
                <Grid>
                    <TextBlock x:Name="DropHintTextBlock"
                               Margin="12"
                               VerticalAlignment="Top"
                               Foreground="#6B7280"
                               Text="ここへ Plugin/Paper の *.jar をドラッグ＆ドロップできます。" />
                    <DataGrid x:Name="PluginsDataGrid"
                              Margin="8,28,8,8"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              SelectionMode="Extended"
                              AllowDrop="True"
                              DragOver="PluginsDataGrid_DragOver"
                              Drop="PluginsDataGrid_Drop">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="種別" Binding="{Binding TargetKindText}" Width="0.8*" />
                            <DataGridTextColumn Header="名称" Binding="{Binding PluginName}" Width="1.8*" />
                            <DataGridTextColumn Header="現在バージョン" Binding="{Binding CurrentVersion}" Width="*" />
                            <DataGridTextColumn Header="ファイル名" Binding="{Binding FileName}" Width="1.8*" />
                            <DataGridTextColumn Header="解析状態" Binding="{Binding DetectionStatus}" Width="1.3*" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </GroupBox>

            <GroupBox Grid.Column="1" Header="ダウンロード結果" Margin="6,0,0,0">
                <DataGrid x:Name="ResultsDataGrid"
                          Margin="8"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="プラグイン名" Binding="{Binding PluginName}" Width="1.5*" />
                        <DataGridTextColumn Header="現在" Binding="{Binding CurrentVersion}" Width="*" />
                        <DataGridTextColumn Header="最新" Binding="{Binding LatestVersion}" Width="*" />
                        <DataGridTextColumn Header="取得元" Binding="{Binding Provider}" Width="*" />
                        <DataGridTextColumn Header="状態" Binding="{Binding Status}" Width="*" />
                        <DataGridTextColumn Header="保存先" Binding="{Binding SavedPath}" Width="2.3*" />
                        <DataGridTextColumn Header="詳細" Binding="{Binding Message}" Width="2*" />
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>
        </Grid>

        <StatusBar Grid.Row="3" Margin="0,10,0,0" Padding="4,0">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="準備完了" />
            </StatusBarItem>
            <Separator />
            <StatusBarItem Width="260">
                <ProgressBar x:Name="ProgressBar" Height="16" Minimum="0" Maximum="1" Value="0" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
